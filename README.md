

# Spellcast

It's like 'make', but with a touch of Wizardry.

This Scroll is still a work in progress (specs, etc...)

* License: MIT
* Current status: early alpha / unstable / hazardous magical energy / DO NOT USE YET!
* Platform: Node.js only
* Are-we-better-yet: **No.**



Full BDD spec generated by Mocha:


echo
delayed-echo
bob blihblih one
scroll line: one
scroll line: three
scroll line: two
scroll line: one
scroll line: three
scroll line: two
one more time: one
one more time: two
one more time: three
end: one
# TOC
   - [Formula](#formula)
   - ['sh' block](#sh-block)
   - ['foreach' block](#foreach-block)
<a name=""></a>
 
<a name="formula"></a>
# Formula
should be parsed into list of string, with an additionnal property 'index' equals to 0.

```js
var book = new spellcast.Book( fs.readFileSync( 'spellbook' ).toString() ) ;

expect( book.formula.alert ).to.be.eql( [ 'bob' ] ) ;
expect( book.formula.list ).to.be.eql( [ 'one' , 'two' , 'three' ] ) ;
```

<a name="sh-block"></a>
# 'sh' block
should echoing echo.

```js
cleanup( function() {
	
	var book = new spellcast.Book( fs.readFileSync( 'spellbook' ).toString() ) ;
	
	book.cast( 'echo' , function( error )
	{
		expect( error ).not.ok() ;
		expect( getCastedLog( 'echo' ) ).to.be( 'echo\n' ) ;
		done() ;
	} ) ;
} ) ;
```

should echoing delayed-echo after one second.

```js
cleanup( function() {
	
	var book = new spellcast.Book( fs.readFileSync( 'spellbook' ).toString() ) ;
	
	book.cast( 'delayed-echo' , function( error )
	{
		expect( error ).not.ok() ;
		expect( getCastedLog( 'delayed-echo' ) ).to.be( 'delayed-echo\n' ) ;
		done() ;
	} ) ;
} ) ;
```

should substitute variable (aka formula) accordingly in 'sh' block.

```js
cleanup( function() {
	
	var book = new spellcast.Book( fs.readFileSync( 'spellbook' ).toString() ) ;
	
	book.cast( 'kawarimi' , function( error )
	{
		expect( error ).not.ok() ;
		expect( getCastedLog( 'kawarimi' ) ).to.be( 'bob blihblih one\n' ) ;
		done() ;
	} ) ;
} ) ;
```

should write a new formula with the output of an 'sh' block.

```js
cleanup( function() {
	
	var book = new spellcast.Book( fs.readFileSync( 'spellbook' ).toString() ) ;
	
	book.cast( 'write-formula' , function( error )
	{
		expect( error ).not.ok() ;
		expect( getCastedLog( 'write-formula' ) ).to.be( 'scroll line: one\nscroll line: three\nscroll line: two\nscroll line: one\nscroll line: three\nscroll line: two\n' ) ;
		done() ;
	} ) ;
} ) ;
```

<a name="foreach-block"></a>
# 'foreach' block
should .

```js
cleanup( function() {
	
	var book = new spellcast.Book( fs.readFileSync( 'spellbook' ).toString() ) ;
	
	book.cast( 'foreach' , function( error )
	{
		expect( error ).not.ok() ;
		expect( getCastedLog( 'foreach' ) ).to.be( 'one more time: one\none more time: two\none more time: three\nend: one\n' ) ;
		done() ;
	} ) ;
} ) ;
```

