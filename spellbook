[[doctype spellcaster]]

[formula]
	browserify: ./node_modules/.bin/browserify
	uglify: ./node_modules/.bin/uglifyjs

[spell test]
	[summon]
		- lib/*
		- lib/*/*
		- test/*
	[scroll]
		- > tea-time





# Browser client

# Do not work ATM, the execution does not finish, hence no undead mode can kick in
[spell dev-browser]
	[cast]
		- browser
	[scroll store=$pid silence]
		> ps x | grep spellcast | grep websocket
	[set $regex] <RegExp> /^([0-9]+)[\s\S]*$/$1/m
	[set $pid] $= $regex.substitute -> $pid
	[message]
		$> kill ${pid}
	[scroll]
		- $> kill ${pid}
		- $> cd sample/adventure ; ../../bin/spellcast --ui websocket

[spell browser]
	[summon]
		- browser/app.html
		- browser/app.min.js
		- browser/app.css

[summoning browser/app.html]
	[summon]
		- lib/clients/web/app.html
	[scroll]
		- > cp lib/clients/web/app.html browser/app.html

[summoning browser/app.css]
	[summon]
		- lib/clients/web/app.css
	[scroll]
		- > cp lib/clients/web/app.css browser/app.css

[summoning browser/app.js]
	[summon]
		- lib/clients/web/app.js
		- lib/clients/web/ui/*.js
	[scroll]
		- $> ${browserify} lib/clients/web/app.js -s SpellcastClient -o browser/app.js

[summoning browser/app.min.js]
	[summon]
		- browser/app.js
	[scroll]
		- $> ${uglify} browser/app.js -o browser/app.min.js -m





# Cosmetics

[prologue]
	[chant]
		$>
		$> ^M^/The Book of the Books
		$>
		
	[fortune]
		-
			$> ^K^/“He drew his dagger, that was sae sharp,
			$>    That was sae sharp and meet,
			$>  And drave it into the nut-browne bride,
			$>    That fell deid at his feit.
			$>
			$> ‘Now stay for me, dear Annet,’ he sed,
			$>   ‘Now stay, my dear,’ he cry’d;
			$>  Then strake the dagger untill his heart,
			$>    And fell deid by her side.”
			$>
			$>      -- “Lord Thomas and Fair Annet”, circa 1650.
			$>
		-
			$> ^K^/“O Bell my wife, why dost thou flyte?
			$>   Now is now, and then was then:
			$> Seek now all the world throughout,
			$>   Thou kens not clowns from gentlemen:
			$> They are clad in black, green, yellow and blue,
			$>   So far above their own degree.
			$> Once in my life I’ll take a view;
			$>   For I’ll have a new cloak about me.”
			$> 
			$>     -- Anonymous, “The Old Cloak”. 16th Century.
			$>

[epilogue]
	[chant]
		$>
		$> ^M^/That's all folks!
		$>

