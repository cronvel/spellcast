
[[doctype adventurer]]

[module] @@../../script-lib/rpg/rpg.kfg
[module] @@data.kfg

[action drink]
	[message]
		$> You drink a cup of vine...


[role hero]
	[label] You
	[entity] player



[chapter intro]
	[starting-scene init]
		#[debug info] $roles.hero.entity.equippedItems.hand
		#[debug info] $roles.hero.entity.actual
		#[debug info] $roles.hero.entity
		
		[next goblin-camp]
			[label] Multiple foes.
		[next first-encounter]
			[label] One foe.
	
	[scene goblin-camp]
		[message]
			$> You are in a middle of a goblin camp, there are half a dozen of tents.
			$> A goblin go out of his tent, see you, and shouts!
			$> Twelve other goblins are going out of their tents, ready to fight you!
			$> The stray dog that was following you barks angrily, and jump in the battle at your side!
		
		[create-entity $dog]
			model: dog
			label: the stray dog
		
		[create-entity $goblin-boss]
			model: goblin
			label: the goblin boss
			params:
				xpReward: 5
			stats:
				fighting: 12
				strength: 10
				resilience: 12
			stances:
				offensiveness: -1
			equippedItems:
				hand:
					- spear
					- shield
		
		[gosub fighting/init]
			[args]
				distance: 16
				allies:
					- $roles.hero.entity
					- $dog
				foes:
					- goblin
					- goblin
					- goblin
					- goblin
					- goblin
					- goblin
					- $goblin-boss
					- goblin
					- goblin
					- goblin
					- goblin
					- goblin
					- goblin
		
		[next first-encounter]

	[scene first-encounter]
		[message]
			$> You are walking alongside a dangerous cliff.
			$> Suddenly, a big and tough guy appears.
			$> He does not say much except grumbling something like “I'm the guardian”, then he starts rushing you with a giant club.
		
		[gosub fighting/init]
			[args]
				distance: 10
				allies:
					- $roles.hero.entity
				foes:
					- guardian
				deadlyPush:
					bonus: 0
					flavour:
						$$> ^R${performer.label//uc1} pushes ${target.label} and ${target.label} falls off the cliff!
		
		[next second-encounter]

	[scene second-encounter]
		[message]
			$> You are moving slowly on a wooden beam, over a chasm.
			$> You find it really difficult to walk without falling, yet, another guardian appears at the other end of the beam.
			$> Instead of waiting for you, he starts walking on the beam toward you.
			$> He swings the air with its giant club as he taunts you, inviting you to go ahead fighting him.
		
		[gosub fighting/init]
			[args]
				distance: 10
				allies:
					- $roles.hero.entity
				foes:
					- guardian
				deadlyPush:
					bonus: 6
					flavour:
						$$> ^RAs ${performer.label} charges, ${target.label} slips from the wooden beam!
						$$> ${target.label//uc1} falls into the chasm!


