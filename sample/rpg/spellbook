
[[doctype adventurer]]

[module] @@battle.kfg

[action drink]
	[message]
		$> You drink a cup of vine...

[entity-model player]
	class: character
	label: the hero
	stats:
		fighting: 16
		strength: 12
		hp: 20
		mana: 20
	status:
		hp: 20
		mana: 20
		xp: 0

[entity-model dog]
	class: character
	label: the dog
	params:
		xpReward: 5
	stats:
		fighting: 12
		strength: 12
		hp: 12
	status:
		hp: 12

[entity-model goblin]
	class: character
	label:
		- the pesky goblin
		- the dirty goblin
		- the mad goblin
		- the maniac goblin
		- the goofy goblin
		- the irritating goblin
		- the irksome goblin
		- the bald-headed goblin
		- the insane goblin
		- the angry goblin
		- the shaggy goblin
		- the hairy goblin
		- the stinking goblin
		- the green goblin
		- the brown goblin
		- the glaucous goblin
		- the tiny goblin
		- the edgy goblin
		- the restless goblin
		- the shivering goblin
		- the malicious goblin
		- the nasty goblin
		- the disgusting goblin
		- the ugly goblin
	params:
		xpReward: 2
	stats:
		fighting: 8
		strength: 6
		hp: 6
	status:
		hp: 6

[entity-model guardian]
	class: character
	label: the guardian
	params:
		xpReward: 10
		charge: 0.5
	stats:
		fighting: 14
		strength: 16
		hp: 20
	status:
		hp: 20

[role hero]
	[label] You
	[entity] player



[chapter intro]
	[starting-scene init]
		[next goblin-camp]
			[label] Multiple foes.
		[next first-encounter]
			[label] One foe.
	
	[scene goblin-camp]
		[message]
			$> You are in a middle of a goblin camp, there are half a dozen of tents.
			$> A goblin go out of his tent, see you, and shouts!
			$> Twelve other goblins are going out of their tents, ready to fight you!
			$> The stray dog that was following you barks angrily, and jump in the battle at your side!
		
		[create-entity $dog]
			model: dog
			label: the stray dog
		
		[create-entity $goblin-boss]
			model: goblin
			label: the goblin boss
			params:
				xpReward: 5
			stats:
				fighting: 12
				strength: 10
				hp: 16
			status:
				hp: 16
		
		[gosub battle/init]
			[args]
				allies:
					- $roles.hero.entity
					- $dog
				foes:
					- goblin
					- goblin
					- goblin
					- goblin
					- goblin
					- goblin
					- $goblin-boss
					- goblin
					- goblin
					- goblin
					- goblin
					- goblin
					- goblin
		
		[next first-encounter]

	[scene first-encounter]
		[message]
			$> You are walking alongside a dangerous cliff.
			$> Suddenly, a big and tough guy appears.
			$> He does not say much except grumbling something like “I'm the guardian” and start rushing you with a giant club.
		
		[gosub battle/init]
			[args]
				allies:
					- $roles.hero.entity
				foes:
					- guardian
				deadlyPush:
					bonus: 0
					flavour:
						$$> ^R${attacker.label//uc1} pushes ${defender.label} and ${defender.label} falls off the cliff!
		
		[next second-encounter]

	[scene second-encounter]
		[message]
			$> You are moving slowly on a wooden beam, over a chasm.
			$> You find it really difficult to walk without falling, yet, another guardian appears at the other end of the beam.
			$> Instead of waiting for you, he starts walking on the beam toward you.
			$> He swings the air with its giant club as he taunts you, inviting you to go ahead fighting him.
		
		[gosub battle/init]
			[args]
				allies:
					- $roles.hero.entity
				foes:
					- guardian
				deadlyPush:
					bonus: 6
					flavour:
						$$> ^RAs ${attacker.label} charges, ${defender.label} slips from the wooden beam!
						$$> ${defender.label//uc1} falls into the chasm!


