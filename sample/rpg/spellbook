
[[doctype adventurer]]

[module] @@battle.kfg

[action drink]
	[message]
		$> You drink a cup of vine...

[entity-class character]
	usages:


[compound-stats character]
	attack: $= $stats.fighting
	defense: $= $stats.fighting
	damages: $= $stats.strength / 2
	
[compound-stats character melee]
	attack: $= $stats.fighting
	defense: $= $stats.fighting
	damages: $= $stats.strength / 2

[item-model ring-of-fighting-spirit]
	class: jewel
	label: ring of fighting spirit
	slotType: ring
	slotCount: 1
	stats:
		fighting: (+) 1

[item-model sword]
	class: melee-weapon
	label: sword
	slotType: hand
	slotCount: 1
	stats:
	#	fighting: (+) 4
	compound:
		attack: (+) 4
		defense: (+) 4
		damages: (+) 4
	
	domains:
		melee:
			compound:
				attack: (+) 4
				defense: (+) 4
				damages: (+) 4

[item-model axe]
	class: melee-weapon
	label: axe
	slotType: hand
	slotCount: 1
	stats:
	#	fighting: (+) 4
	compound:
		attack: (+) 4
		defense: (+) 2
		damages: (+) 6
	
[item-model spear]
	class: melee-weapon
	label: spear
	slotType: hand
	slotCount: 1
	stats:
	#	fighting: (+) 2
	compound:
		attack: (+) 3
		defense: (+) 5
		damages: (+) 3

[item-model giant-club]
	class: melee-weapon
	label: giant club
	slotType: hand
	slotCount: 2
	stats:
	#	fighting: (+) 2
	compound:
		attack: (+) 2
		defense: (+) 2
		damages: (+) 8

[entity-model player]
	class: character
	label: the hero
	slots:
		hand: 2
		armor: 1
		ring: 2
	stats:
		fighting: 15
		strength: 12
		hp: 20
		mana: 20
	status:
		hp: 20
		mana: 20
		xp: 0
	equippedItems:
		hand:
			- sword
		ring:
			- ring-of-fighting-spirit

[entity-model dog]
	class: character
	label: the dog
	params:
		xpReward: 5
	stats:
		fighting: 12
		strength: 12
		hp: 12
	status:
		hp: 12

[entity-model goblin]
	class: character
	label:
		- the pesky goblin
		- the dirty goblin
		- the mad goblin
		- the maniac goblin
		- the goofy goblin
		- the irritating goblin
		- the irksome goblin
		- the bald-headed goblin
		- the insane goblin
		- the angry goblin
		- the shaggy goblin
		- the hairy goblin
		- the stinking goblin
		- the green goblin
		- the brown goblin
		- the glaucous goblin
		- the tiny goblin
		- the edgy goblin
		- the restless goblin
		- the shivering goblin
		- the malicious goblin
		- the nasty goblin
		- the disgusting goblin
		- the ugly goblin
	params:
		xpReward: 2
	slots:
		hand: 2
		armor: 1
	stats:
		fighting: 8
		strength: 6
		hp: 6
	status:
		hp: 6
	equippedItems:
		hand:
			- spear

[entity-model guardian]
	class: character
	label: the guardian
	params:
		xpReward: 10
		charge: 0.5
	slots:
		hand: 2
		armor: 1
	stats:
		fighting: 14
		strength: 16
		hp: 20
	status:
		hp: 20
	equippedItems:
		hand:
			- giant-club

[role hero]
	[label] You
	[entity] player



[chapter intro]
	[starting-scene init]
		#[debug info] $roles.hero.entity.equippedItems.hand
		#[debug info] $roles.hero.entity.actual
		#[debug info] $roles.hero.entity
		
		[next goblin-camp]
			[label] Multiple foes.
		[next first-encounter]
			[label] One foe.
	
	[scene goblin-camp]
		[message]
			$> You are in a middle of a goblin camp, there are half a dozen of tents.
			$> A goblin go out of his tent, see you, and shouts!
			$> Twelve other goblins are going out of their tents, ready to fight you!
			$> The stray dog that was following you barks angrily, and jump in the battle at your side!
		
		[create-entity $dog]
			model: dog
			label: the stray dog
		
		[create-entity $goblin-boss]
			model: goblin
			label: the goblin boss
			params:
				xpReward: 5
			stats:
				fighting: 12
				strength: 10
				hp: 16
			status:
				hp: 16
		
		[gosub battle/init]
			[args]
				allies:
					- $roles.hero.entity
					- $dog
				foes:
					- goblin
					- goblin
					- goblin
					- goblin
					- goblin
					- goblin
					- $goblin-boss
					- goblin
					- goblin
					- goblin
					- goblin
					- goblin
					- goblin
		
		[next first-encounter]

	[scene first-encounter]
		[message]
			$> You are walking alongside a dangerous cliff.
			$> Suddenly, a big and tough guy appears.
			$> He does not say much except grumbling something like “I'm the guardian” and start rushing you with a giant club.
		
		[gosub battle/init]
			[args]
				allies:
					- $roles.hero.entity
				foes:
					- guardian
				deadlyPush:
					bonus: 0
					flavour:
						$$> ^R${attacker.label//uc1} pushes ${defender.label} and ${defender.label} falls off the cliff!
		
		[next second-encounter]

	[scene second-encounter]
		[message]
			$> You are moving slowly on a wooden beam, over a chasm.
			$> You find it really difficult to walk without falling, yet, another guardian appears at the other end of the beam.
			$> Instead of waiting for you, he starts walking on the beam toward you.
			$> He swings the air with its giant club as he taunts you, inviting you to go ahead fighting him.
		
		[gosub battle/init]
			[args]
				allies:
					- $roles.hero.entity
				foes:
					- guardian
				deadlyPush:
					bonus: 6
					flavour:
						$$> ^RAs ${attacker.label} charges, ${defender.label} slips from the wooden beam!
						$$> ${defender.label//uc1} falls into the chasm!


